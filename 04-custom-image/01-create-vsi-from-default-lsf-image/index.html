<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.96.0"><meta name=description content="HPC on IBM Cloud Tutorials"><link rel="shortcut icon" href=https://ibm.github.io/ibmcloud-hpc-tutorials/images/favicon.png type=image/x-icon><title>Create VSI From Default LSF Image :: HPC on IBM Cloud Tutorials</title><link href=https://ibm.github.io/ibmcloud-hpc-tutorials/css/nucleus.css?1648695131 rel=stylesheet><link href=https://ibm.github.io/ibmcloud-hpc-tutorials/css/fontawesome-all.min.css?1648695131 rel=stylesheet><link href=https://ibm.github.io/ibmcloud-hpc-tutorials/css/hybrid.css?1648695131 rel=stylesheet><link href=https://ibm.github.io/ibmcloud-hpc-tutorials/css/featherlight.min.css?1648695131 rel=stylesheet><link href=https://ibm.github.io/ibmcloud-hpc-tutorials/css/perfect-scrollbar.min.css?1648695131 rel=stylesheet><link href=https://ibm.github.io/ibmcloud-hpc-tutorials/css/auto-complete.css?1648695131 rel=stylesheet><link href=https://ibm.github.io/ibmcloud-hpc-tutorials/css/atom-one-dark-reasonable.css?1648695131 rel=stylesheet><link href=https://ibm.github.io/ibmcloud-hpc-tutorials/css/theme.css?1648695131 rel=stylesheet><link href=https://ibm.github.io/ibmcloud-hpc-tutorials/css/tabs.css?1648695131 rel=stylesheet><link href=https://ibm.github.io/ibmcloud-hpc-tutorials/css/hugo-theme.css?1648695131 rel=stylesheet><link href=https://ibm.github.io/ibmcloud-hpc-tutorials/css/theme-ibm.css?1648695131 rel=stylesheet><script src=https://ibm.github.io/ibmcloud-hpc-tutorials/js/jquery-3.3.1.min.js?1648695131></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=https://ibm.github.io/ibmcloud-hpc-tutorials/04-custom-image/01-create-vsi-from-default-lsf-image/><nav id=sidebar><div id=header-wrapper><div id=header><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/ title="Go home"><img id=preview-image src=https://ibm.github.io/ibmcloud-hpc-tutorials/images/IBM_Cloud_Lockup_v1.png crossorigin=anonymous style=border-width:0 width=800><a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=https://ibm.github.io/ibmcloud-hpc-tutorials/js/lunr.min.js?1648695131></script>
<script type=text/javascript src=https://ibm.github.io/ibmcloud-hpc-tutorials/js/auto-complete.js?1648695131></script>
<script type=text/javascript>var baseurl="https://ibm.github.io/ibmcloud-hpc-tutorials/"</script><script type=text/javascript src=https://ibm.github.io/ibmcloud-hpc-tutorials/js/search.js?1648695131></script></div><section id=homelinks><ul><li><a class=padding href=https://ibm.github.io/ibmcloud-hpc-tutorials/><i class="fas fa-home"></i> Home</a></li></ul></section><div class=highlightable><ul class=topics><li data-nav-id=/01-hpc-overview/ title="HPC on Cloud Overview" class=dd-item><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/01-hpc-overview/><b>I ⁃ </b>HPC on Cloud Overview</a></li><li data-nav-id=/02-setup-lsf-cluster/ title="Standing up an LSF Cluster" class=dd-item><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/02-setup-lsf-cluster/><b>II ⁃ </b>Standing up an LSF Cluster</a><ul><li data-nav-id=/02-setup-lsf-cluster/01-sshkey-api/ title="Prepare SSH and API Keys" class=dd-item><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/02-setup-lsf-cluster/01-sshkey-api/>Prepare SSH and API Keys</a></li><li data-nav-id=/02-setup-lsf-cluster/02-hpc-cluster-catalog/ title="Create Your Cluster using IBM Spectrum LSF" class=dd-item><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/02-setup-lsf-cluster/02-hpc-cluster-catalog/>Create Your Cluster using IBM Spectrum LSF</a></li><li data-nav-id=/02-setup-lsf-cluster/03-access-cluster/ title="Access Your Cluster" class=dd-item><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/02-setup-lsf-cluster/03-access-cluster/>Access Your Cluster</a></li><li data-nav-id=/02-setup-lsf-cluster/04-run-job/ title="Run LSF Jobs Using Auto-Scaling" class=dd-item><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/02-setup-lsf-cluster/04-run-job/>Run LSF Jobs Using Auto-Scaling</a></li><li data-nav-id=/02-setup-lsf-cluster/05-manage-cluster/ title="Manage your Cluster" class=dd-item><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/02-setup-lsf-cluster/05-manage-cluster/>Manage your Cluster</a></li></ul></li><li data-nav-id=/03-bursting/ title="Cloud Bursting" class=dd-item><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/03-bursting/><b>III ⁃ </b>Cloud Bursting</a><ul><li data-nav-id=/03-bursting/01-onprem_cluster/ title="Emulate an on-premise cluster" class=dd-item><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/03-bursting/01-onprem_cluster/>Emulate an on-premise cluster</a></li><li data-nav-id=/03-bursting/02-onprem-vpn/ title="Set up VPN for the on-premise cluster" class=dd-item><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/03-bursting/02-onprem-vpn/>Set up VPN for the on-premise cluster</a></li><li data-nav-id=/03-bursting/03-cloud_cluster_step/ title="Create a second cluster and establish VPN connection" class=dd-item><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/03-bursting/03-cloud_cluster_step/>Create a second cluster and establish VPN connection</a></li><li data-nav-id=/03-bursting/04-multicluster/ title="Set up LSF multi-cluster and job forwarding" class=dd-item><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/03-bursting/04-multicluster/>Set up LSF multi-cluster and job forwarding</a></li></ul></li><li data-nav-id=/04-custom-image/ title="Custom Image (Under Construction)" class="dd-item
parent"><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/04-custom-image/><b>IV ⁃ </b>Custom Image (Under Construction)</a><ul><li data-nav-id=/04-custom-image/01-create-vsi-from-default-lsf-image/ title="Create VSI From Default LSF Image" class="dd-item active"><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/04-custom-image/01-create-vsi-from-default-lsf-image/>Create VSI From Default LSF Image</a></li><li data-nav-id=/04-custom-image/02-customize-software-on-the-vsi/ title="Customize Software on the VSI" class=dd-item><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/04-custom-image/02-customize-software-on-the-vsi/>Customize Software on the VSI</a></li><li data-nav-id=/04-custom-image/03-create-image-from-customized-volume/ title="Create Image From Customized Volume" class=dd-item><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/04-custom-image/03-create-image-from-customized-volume/>Create Image From Customized Volume</a></li><li data-nav-id=/04-custom-image/04-create-cluster-from-custom-image/ title="Create Cluster From Custom Image" class=dd-item><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/04-custom-image/04-create-cluster-from-custom-image/>Create Cluster From Custom Image</a></li></ul></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://github.com/IBM/ibmcloud-hpc-tutorials><i class="fab fa-github"></i> Github</a></li><li><a class=padding href=https://www.ibm.com/cloud/hpc><i class="fas fa-bookmark"></i> IBM Cloud HPC</a></li><li><a class=padding href=https://ibm.github.io/ibmcloud-hpc-tutorials/authors/><i class="fas fa-users"></i> Authors</a></li><li><a class=padding href=https://github.com/IBM/ibmcloud-hpc-tutorials/issues><i class="fas fa-envelope"></i> Feedback / Questions?</a></li><li><a class=padding href=https://ibm.github.io/ibmcloud-hpc-tutorials/tags><i class="fas fa-tags"></i> Tags</a></li></ul></section><section id=footer><left><br><a href=https://www.ibm.com/privacy>Privacy</a> | <a href=https://www.ibm.com/support/customer/csol/terms/>Site Terms</a> | © 2022, IBM Corp. or its affiliates. All rights reserved.</left></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/IBM/ibmcloud-hpc-tutorials/tree/main/content/04-custom-image/01-create-vsi-from-default-lsf-image.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=https://ibm.github.io/ibmcloud-hpc-tutorials/>HPC on IBM Cloud Tutorials</a> > <a href=https://ibm.github.io/ibmcloud-hpc-tutorials/04-custom-image/>Custom Image (Under Construction)</a> > Create VSI From Default LSF Image</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#start-ibm-cloud-shell-from-the-browser>Start IBM Cloud Shell from the browser</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Create VSI From Default LSF Image</h1><h2 id=start-ibm-cloud-shell-from-the-browser>Start IBM Cloud Shell from the browser</h2><p>Find the icon to lauch Cloud Shell in the dash board:</p><p><img src=https://ibm.github.io/ibmcloud-hpc-tutorials/images/custom-image/cloud-shell-1.png alt="Cloud Shell Icon"></p><p>It will create another browser window with the Cloud Shell:</p><p><img src=https://ibm.github.io/ibmcloud-hpc-tutorials/images/custom-image/cloud-shell-2.png alt="Cloud Shell"></p><p>In the Cloud Shell, follow the next steps to create a VSI (assuming bash):</p><ol><li>Assign values to environment variables for commands later</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Replace CLUSTER_PREFIX with the one you used to create the existing LSF cluster</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Replace KEY_NAME, RESOURCE_GROUP_NAME, ZONE_NAME and CLUSTER_IMG_ID as needed</span>
</span></span><span style=display:flex><span>CLUSTER_PREFIX<span style=color:#f92672>=</span>&lt;cluster-name-prefix&gt;
</span></span><span style=display:flex><span>CLUSTER_VPC_NAME<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>CLUSTER_PREFIX<span style=color:#e6db74>}</span>-vpc
</span></span><span style=display:flex><span>CLUSTER_SUBNET_NAME<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>CLUSTER_PREFIX<span style=color:#e6db74>}</span>-subnet
</span></span><span style=display:flex><span>CLUSTER_IMG_ID<span style=color:#f92672>=</span>r006-68478a2e-4abc-4bfb-9e4f-a6fb3b9b235f
</span></span><span style=display:flex><span>CLUSTER_SG_NAME<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>CLUSTER_PREFIX<span style=color:#e6db74>}</span>-sg
</span></span><span style=display:flex><span>CUSTOM_IMG_NAME<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>CLUSTER_PREFIX<span style=color:#e6db74>}</span>-custom-img
</span></span><span style=display:flex><span>CUSTOM_IMG_VSI_NAME<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>CUSTOM_IMG_NAME<span style=color:#e6db74>}</span>-vsi
</span></span><span style=display:flex><span>ZONE_NAME<span style=color:#f92672>=</span>us-south-3
</span></span><span style=display:flex><span>PROFILE_NAME<span style=color:#f92672>=</span>bx2-2x8
</span></span><span style=display:flex><span>KEY_NAME<span style=color:#f92672>=</span>ccyang-pub-key
</span></span><span style=display:flex><span>RESOURCE_GROUP_NAME<span style=color:#f92672>=</span>Default
</span></span></code></pre></div><p>The <code>CLUSTER_IMG_ID</code> can be found from <a href=https://github.com/IBM-Cloud/hpc-cluster-lsf/blob/main/image-map.tf>the open-source terraform script</a> in IBM Cloud <a href=https://github.com/IBM-Cloud/hpc-cluster-lsf>hpc-cluster-lsf</a> github repository.
You can choose the OS you wish to use. You should make sure the region key is the same as where you will create the VSI and where the custom image should be.</p><ol start=2><li>Create a VSI</li></ol><pre tabindex=0><code>ibmcloud is instance-create \
    ${CUSTOM_IMG_VSI_NAME} \
    ${CLUSTER_VPC_NAME} \
    ${ZONE_NAME} \
    ${PROFILE_NAME} \
    ${CLUSTER_SUBNET_NAME} \
    --image ${CLUSTER_IMG_ID} \
    --keys ${KEY_NAME} \
    --resource-group-name ${RESOURCE_GROUP_NAME} \
    --sgs ${CLUSTER_SG_NAME}
</code></pre><ol start=3><li>Use the following command to check the status of the new VSI. Wait till the instance is in running state.</li></ol><pre tabindex=0><code>ibmcloud is instance ${CUSTOM_IMG_VSI_NAME}
</code></pre><ol start=4><li>Get assigned IP address</li></ol><pre tabindex=0><code>ibmcloud is instance ${CUSTOM_IMG_VSI_NAME} --output JSON | jq -r .network_interfaces[0].primary_ipv4_address
</code></pre><p>Keep the Cloud Shell open, we will reuse it in step 03 to create the custom image.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=https://ibm.github.io/ibmcloud-hpc-tutorials/04-custom-image/ title="Custom Image (Under Construction)"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=https://ibm.github.io/ibmcloud-hpc-tutorials/04-custom-image/02-customize-software-on-the-vsi/ title="Customize Software on the VSI" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=https://ibm.github.io/ibmcloud-hpc-tutorials/js/clipboard.min.js?1648695131></script>
<script src=https://ibm.github.io/ibmcloud-hpc-tutorials/js/perfect-scrollbar.min.js?1648695131></script>
<script src=https://ibm.github.io/ibmcloud-hpc-tutorials/js/perfect-scrollbar.jquery.min.js?1648695131></script>
<script src=https://ibm.github.io/ibmcloud-hpc-tutorials/js/jquery.sticky.js?1648695131></script>
<script src=https://ibm.github.io/ibmcloud-hpc-tutorials/js/featherlight.min.js?1648695131></script>
<script src=https://ibm.github.io/ibmcloud-hpc-tutorials/js/highlight.pack.js?1648695131></script>
<script>hljs.initHighlightingOnLoad()</script><script src=https://ibm.github.io/ibmcloud-hpc-tutorials/js/modernizr.custom-3.6.0.js?1648695131></script>
<script src=https://ibm.github.io/ibmcloud-hpc-tutorials/js/learn.js?1648695131></script>
<script src=https://ibm.github.io/ibmcloud-hpc-tutorials/js/hugo-learn.js?1648695131></script>
<script src=https://ibm.github.io/ibmcloud-hpc-tutorials/mermaid/mermaid.js?1648695131></script>
<script>mermaid.initialize({startOnLoad:!0})</script></body></html>